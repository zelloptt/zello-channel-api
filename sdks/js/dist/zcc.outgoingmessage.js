!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZCC=t():(e.ZCC=e.ZCC||{},e.ZCC.OutgoingMessage=t())}(self,(()=>{return e={668:e=>{e.exports=function(e){return atob(e)}},2:e=>{e.exports={libraryName:"ZCC"}},712:e=>{e.exports={ERROR_NOT_ENOUGH_PARAMS:"Not enough parameters",ERROR_INVALID_SERVER_PROTOCOL:"Invalid server protocol, use ws:// or wss://",ERROR_UNSUPPORTED:"Your browser does not support all required APIs.\nRead more here https://github.com/zelloptt/zello-channel-api",ERROR_RECORDING_NO_HTTPS:"Recording will work over https:// loaded pages only",ERROR_WIDGET_ELEMENT_NOT_FOUND:"DOM element for widget is not found",ERROR_INVALID_DECODER:"Invalid incoming message decoder. Should implement ZCC.Decoder interface",ERROR_INVALID_PLAYER:"Invalid incoming message player. Should implement ZCC.Player interface",ERROR_INVALID_RECORDER:"Invalid outgoing message recorder. Should implement ZCC.Recorder interface",ERROR_INVALID_ENCODER:"Invalid outgoing message encoder. Should implement ZCC.Encoder interface",ERROR_SESSION_FAIL_CONNECT:"Failed to connect",ERROR_INVALID_IMAGE_WIDTH_OR_HEIGHT:"Invalid image width or height",ERROR_FAILED_TO_SEND_IMAGE:"Failed to send image",ERROR_IMAGE_NOT_READY_TO_BE_SENT:"Image is not ready to be sent",ERROR_NO_CAMERA_AVAILABLE:"No camera available",ERROR_TYPE_UNKNOWN_SERVER_ERROR:"Unknown server error",ERROR_TYPE_CONFIGURATION:"configuration",EVENT_ERROR:"error",EVENT_CONNECT:"connect",EVENT_CLOSE:"close",EVENT_LOGON:"logon",EVENT_STATUS:"status",EVENT_START_STREAM:"start_stream",EVENT_STOP_STREAM:"stop_stream",EVENT_SESSION_START_CONNECT:"session_start_connect",EVENT_SESSION_CONNECT:"session_connect",EVENT_SESSION_FAIL_CONNECT:"session_fail_connect",EVENT_SESSION_CONNECTION_LOST:"session_connection_lost",EVENT_SESSION_DISCONNECT:"session_disconnect",EVENT_INCOMING_VOICE_WILL_START:"incoming_voice_will_start",EVENT_INCOMING_VOICE_DID_START:"incoming_voice_did_start",EVENT_INCOMING_VOICE_DID_STOP:"incoming_voice_did_stop",EVENT_INCOMING_VOICE_FAIL_START:"incoming_voice_fail_start",EVENT_OUTGOING_VOICE_DID_STOP:"outgoing_voice_did_stop",EVENT_INCOMING_VOICE_DATA:"incoming_voice_data",EVENT_INCOMING_VOICE_DATA_DECODED:"incoming_voice_data_decoded",EVENT_INCOMING_IMAGE_DATA:"incoming_image_data",EVENT_DATA:"data",EVENT_DATA_ENCODED:"data_encoded",EVENT_ENCODER_DONE:"encoder_done",EVENT_RECORDER_READY:"recorder_ready",EVENT_WIDGET_OPEN_BUTTON_CLICK:"widget_open_button_click",EVENT_WIDGET_MUTE:"widget_mute",EVENT_WIDGET_UNMUTE:"widget_unmute",EVENT_WIDGET_SPEAKING_USERNAME_CLICK:"speaking_username_click",EVENT_INCOMING_TEXT_MESSAGE:"incoming_text_message",EVENT_INCOMING_LOCATION:"incoming_location",EVENT_INCOMING_IMAGE:"incoming_image",EVENT_IMAGE_DATA:"image_data",EVENT_THUMBNAIL_DATA:"thumbnail_data",EVENT_IMAGE_PREVIEW_DATA:"image_preview_data",EVENT_THUMBNAIL_PREVIEW_DATA:"thumbnail_preview_data",EVENT_DISPATCH_CALL_STATUS:"dispatch_call_status",MAX_OUTGOING_IMAGE_SCALE_PX:1280,OUTGOING_IMAGE_THUMBNAIL_SCALE_PX:90,SN_STATUS_SUCCESS:"success",SN_STATUS_ONLINE:"online",SN_STATUS_OFFLINE:"offline",MESSAGE_TYPE_AUDIO:1,MESSAGE_TYPE_IMAGE:2,MESSAGE_TYPE_JSON:123,IMAGE_TYPE_FULL:1,IMAGE_TYPE_THUMBNAIL:2,TALK_PRIORITY_VALUE_NORMAL:100,TALK_PRIORITY_VALUE_LOW:10}},706:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=s(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},o.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=u(e);if(t){var i=u(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}var f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(l,e);var t,r,n,s=c(l);function l(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),s.call(this,{wildcard:!0})}return t=l,r=[{key:"emit",value:function(){o(u(l.prototype),"emit",this).apply(this,arguments);var e=arguments[0];e instanceof Array&&e.length>1||"string"==typeof e&&-1!==e.indexOf(".")||(arguments[0]=(arguments[0]instanceof Array?arguments[0][0]:arguments[0])+".*",o(u(l.prototype),"emit",this).apply(this,arguments))}}],r&&i(t.prototype,r),n&&i(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(r(387).EventEmitter2);e.exports=f},711:(e,t,r)=>{function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var i=l(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return c(this,r)}}function c(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}var u=r(706),f=r(712),h=r(338),p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(l,e);var t,r,n,c=a(l);function l(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;i(this,l),t=c.call(this);var o=h.getLoadedLibrary();return t.options=Object.assign({autoStart:!0,recorderSampleRate:44100,encoderFrameSize:20,encoderSampleRate:16e3,encoderApplication:2048},e.options,r),t.userCallback=n,t.options.recorder&&!h.isFunction(t.options.recorder)&&(t.options.recorder=o.Recorder),t.options.encoder&&!h.isFunction(t.options.encoder)&&(t.options.encoder=o.Encoder),t.session=e,t.currentMessageId=null,t.currentPacketId=0,t.initEncoder(),t.initRecorder(),!t.recorder&&t.options.autoStart&&t.start(),t}return t=l,n=[{key:"talkPriorityLow",get:function(){return f.TALK_PRIORITY_VALUE_LOW}},{key:"talkPriorityNormal",get:function(){return f.TALK_PRIORITY_VALUE_NORMAL}}],(r=[{key:"initEncoder",value:function(){var e=this;this.options.encoder&&(this.options.encoder.prototype.ondata=function(t){Array.isArray(t)?t.forEach((function(t){return e.processEncodedData(t)})):e.processEncodedData(t)},this.encoder=new this.options.encoder)}},{key:"processEncodedData",value:function(e){var t=h.buildBinaryPacket(1,this.currentMessageId,++this.currentPacketId,e);this.emit(f.EVENT_DATA_ENCODED,t)}},{key:"initRecorder",value:function(){var e=this;this.options.recorder&&(this.options.recorder.prototype.ondata=function(t){e.emit(f.EVENT_DATA,t),e.encoder.encode(t)},this.options.recorder.prototype.onready=function(){e.sendEncoderInitMessage(),e.options.autoStart&&e.start()},this.recorder=new this.options.recorder(this.options,this.encoder),h.isFunction(this.recorder.init)&&this.recorder.init())}},{key:"sendEncoderInitMessage",value:function(){if(this.encoder&&h.isFunction(this.encoder.postMessage)){var e=this.options.recorderSampleRate;h.isFunction(this.recorder.getSampleRate)&&(e=this.recorder.getSampleRate()),this.encoder.postMessage(Object.assign({command:"init",originalSampleRate:e},this.options))}}},{key:"stopRecording",value:function(){this.recorder&&this.recorder.stop&&this.recorder.stop()}},{key:"startRecording",value:function(){this.recorder&&this.recorder.start&&this.recorder.start()}},{key:"stop",value:function(e){return this.stopRecording(),this.session.stopStream({stream_id:this.currentMessageId},e)}},{key:"start",value:function(){var e=this,t={type:"audio",codec:"opus",codec_header:h.buildCodecHeader(this.options.encoderSampleRate,1,this.options.encoderFrameSize),packet_duration:this.options.encoderFrameSize};this.options.for&&(t.for=this.options.for),void 0!==this.options.talkPriority&&(t.talk_priority=this.options.talkPriority),this.session.startStream(t,this.userCallback).then((function(t){e.currentMessageId=t.stream_id,e.startRecording()})).catch((function(){e.stopRecording()}))}}])&&o(t.prototype,r),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l}(u);e.exports=p},338:(e,t,r)=>{function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=r(2),o=r(634),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,s;return t=e,s=[{key:"getLoadedLibrary",value:function(){return!!window&&window[i.libraryName]}},{key:"strToCamelCase",value:function(e){return e.split(/[-_]/).map((function(e,t){return 0===t?e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join("")}},{key:"getDurationDisplay",value:function(e){var t=Math.floor(e/36e5),r=Math.floor(e/6e4%60),n=Math.floor(e/1e3%60),i=Math.round(e%1e3/100);return i>=10&&(i=9),t>0&&t<10&&(t="0"+t),r>0&&r<10&&(r="0"+r),n>0&&n<10&&(n="0"+n),t?t+":"+r+":"+n+"."+i:r?r+":"+n+"."+i:n?"00:"+n+"."+i:"00:00."+i}},{key:"buildBinaryPacket",value:function(t,r,n,i){var o=new ArrayBuffer(9),s=new DataView(o);return s.setInt8(0,t),s.setInt32(1,r,!1),s.setInt32(5,n,!1),new Uint8Array(e.arrayBufferConcat(o,i))}},{key:"buildCodecHeader",value:function(e,t,r){var n=new ArrayBuffer(4),i=new DataView(n);return i.setUint16(0,e,!0),i.setUint8(2,t),i.setUint8(3,r),btoa(String.fromCharCode.apply(null,new Uint8Array(n)))}},{key:"arrayBufferConcat",value:function(){var e=0,t=null;for(var r in arguments)e+=(t=arguments[r]).byteLength;var n=new Uint8Array(e),i=0;for(var o in arguments)t=arguments[o],n.set(new Uint8Array(t),i),i+=t.byteLength;return n.buffer}},{key:"parseCodedHeader",value:function(e){var t=new DataView(o("data:text/plain;base64,"+e));return{rate:t.getUint16(0,!0),framesPerPacket:t.getUint8(2),frameSize:t.getUint8(3)}}},{key:"isFunction",value:function(t){return e.instanceOf(t,Function)}},{key:"isArray",value:function(t){return e.instanceOf(t,Array)}},{key:"isObject",value:function(t){return e.instanceOf(t,Object)}},{key:"isPromise",value:function(t){return e.isObject(t)&&e.isFunction(t.then)}},{key:"instanceOf",value:function(e,t){return e instanceof t}},{key:"parseIncomingBinaryMessage",value:function(e){var t=new DataView(e.slice(0,9));return{messageType:t.getUint8(0),messageData:new Uint8Array(e.slice(9)),messageId:t.getUint32(1,!1),packetId:t.getUint32(5,!1)}}}],(r=null)&&n(t.prototype,r),s&&n(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}();e.exports=s},387:(e,t,r)=>{var n;!function(i){var o=Object.hasOwnProperty,s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},a="object"==typeof process&&"function"==typeof process.nextTick,c="function"==typeof Symbol,l="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,f=c?l&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function h(){this._events={},this._conf&&p.call(this,this._conf)}function p(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==i&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function _(e,t){var r="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(r+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var n=new Error(r);n.name="MaxListenersExceededWarning",n.emitter=this,n.count=e,process.emitWarning(n)}else console.error(r),console.trace&&console.trace()}var y=function(e,t,r){var n=arguments.length;switch(n){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,r];default:for(var i=new Array(n);n--;)i[n]=arguments[n];return i}};function d(e,t){for(var r={},n=e.length,o=t?value.length:0,s=0;s<n;s++)r[e[s]]=s<o?t[s]:i;return r}function v(e,t,r){var n,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(r.on||r.off)&&(n=r.on,i=r.off),t.addEventListener?(n=t.addEventListener,i=t.removeEventListener):t.addListener?(n=t.addListener,i=t.removeListener):t.on&&(n=t.on,i=t.off),!n&&!i)throw Error("target does not implement any known event API");if("function"!=typeof n)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=n,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function E(e,t,r,n){var s=Object.assign({},t);if(!e)return s;if("object"!=typeof e)throw TypeError("options must be an object");var a,c,l,u=Object.keys(e),f=u.length;function h(e){throw Error('Invalid "'+a+'" option value'+(e?". Reason: "+e:""))}for(var p=0;p<f;p++){if(a=u[p],!n&&!o.call(t,a))throw Error('Unknown "'+a+'" option');(c=e[a])!==i&&(l=r[a],s[a]=l?l(c,h):c)}return s}function m(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function b(e){var t="value must be type of "+e.join("|"),r=e.length,n=e[0],i=e[1];return 1===r?function(e,r){if(typeof e===n)return e;r(t)}:2===r?function(e,r){var o=typeof e;if(o===n||o===i)return e;r(t)}:function(n,i){for(var o=typeof n,s=r;s-- >0;)if(o===e[s])return n;i(t)}}Object.assign(v.prototype,{subscribe:function(e,t,r){var n=this,i=this._target,o=this._emitter,s=this._listeners,a=function(){var n=y.apply(null,arguments),s={data:n,name:t,original:e};if(r){var a=r.call(i,s);!1!==a&&o.emit.apply(o,[s.name].concat(n))}else o.emit.apply(o,[t].concat(n))};if(s[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!n._onNewListener?(this._onNewListener=function(r){r===t&&null===s[e]&&(s[e]=a,n._on.call(i,e,a))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(r){r===t&&!o.hasListeners(r)&&s[e]&&(s[e]=null,n._off.call(i,e,a))},s[e]=null,o.on("removeListener",this._onRemoveListener)):(s[e]=a,n._on.call(i,e,a))},unsubscribe:function(e){var t,r,n,i=this,o=this._listeners,s=this._emitter,a=this._off,c=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function l(){i._onNewListener&&(s.off("newListener",i._onNewListener),s.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=T.call(s,i);s._observers.splice(e,1)}if(e){if(!(t=o[e]))return;a.call(c,e,t),delete o[e],--this._listenersCount||l()}else{for(n=(r=f(o)).length;n-- >0;)e=r[n],a.call(c,e,o[e]);this._listeners={},this._listenersCount=0,l()}}});var g=b(["function"]),w=b(["object","function"]);function O(e,t,r){var n,i,o,s=0,a=new e((function(c,l,u){function f(){i&&(i=null),s&&(clearTimeout(s),s=0)}r=E(r,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),n=!r.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var h=function(e){f(),c(e)},p=function(e){f(),l(e)};n?t(h,p,u):(i=[function(e){p(e||Error("canceled"))}],t(h,p,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),r.timeout>0&&(s=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",s=0,a.cancel(e),l(e)}),r.timeout))}));return n||(a.cancel=function(e){if(i){for(var t=i.length,r=1;r<t;r++)i[r](e);i[0](e),i=null}}),a}function T(e){var t=this._observers;if(!t)return-1;for(var r=t.length,n=0;n<r;n++)if(t[n]._target===e)return n;return-1}function A(e,t,r,n,i){if(!r)return null;if(0===n){var o=typeof t;if("string"===o){var s,a,c=0,l=0,u=this.delimiter,h=u.length;if(-1!==(a=t.indexOf(u))){s=new Array(5);do{s[c++]=t.slice(l,a),l=a+h}while(-1!==(a=t.indexOf(u,l)));s[c++]=t.slice(l),t=s,i=c}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var p,_,y,d,v,E,m,b=null,g=t[n],w=t[n+1];if(n===i)r._listeners&&("function"==typeof r._listeners?(e&&e.push(r._listeners),b=[r]):(e&&e.push.apply(e,r._listeners),b=[r]));else{if("*"===g){for(a=(E=f(r)).length;a-- >0;)"_listeners"!==(p=E[a])&&(m=A(e,t,r[p],n+1,i))&&(b?b.push.apply(b,m):b=m);return b}if("**"===g){for((v=n+1===i||n+2===i&&"*"===w)&&r._listeners&&(b=A(e,t,r,i,i)),a=(E=f(r)).length;a-- >0;)"_listeners"!==(p=E[a])&&("*"===p||"**"===p?(r[p]._listeners&&!v&&(m=A(e,t,r[p],i,i))&&(b?b.push.apply(b,m):b=m),m=A(e,t,r[p],n,i)):m=A(e,t,r[p],p===w?n+2:n,i),m&&(b?b.push.apply(b,m):b=m));return b}r[g]&&(b=A(e,t,r[g],n+1,i))}if((_=r["*"])&&A(e,t,_,n+1,i),y=r["**"])if(n<i)for(y._listeners&&A(e,t,y,i,i),a=(E=f(y)).length;a-- >0;)"_listeners"!==(p=E[a])&&(p===w?A(e,t,y[p],n+2,i):p===g?A(e,t,y[p],n+1,i):((d={})[p]=y[p],A(e,t,{"**":d},n+1,i)));else y._listeners?A(e,t,y,i,i):y["*"]&&y["*"]._listeners&&A(e,t,y["*"],i,i);return b}function N(e,t,r){var n,i,o=0,s=0,a=this.delimiter,c=a.length;if("string"==typeof e)if(-1!==(n=e.indexOf(a))){i=new Array(5);do{i[o++]=e.slice(s,n),s=n+c}while(-1!==(n=e.indexOf(a,s)));i[o++]=e.slice(s)}else i=[e],o=1;else i=e,o=e.length;if(o>1)for(n=0;n+1<o;n++)if("**"===i[n]&&"**"===i[n+1])return;var l,u=this.listenerTree;for(n=0;n<o;n++)if(u=u[l=i[n]]||(u[l]={}),n===o-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),r?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,_.call(this,u._listeners.length,l))):u._listeners=t,!0;return!0}function L(e,t,r,n){for(var i,o,s,a,c=f(e),l=c.length,u=e._listeners;l-- >0;)i=e[o=c[l]],s="_listeners"===o?r:r?r.concat(o):[o],a=n||"symbol"==typeof o,u&&t.push(a?s:s.join(this.delimiter)),"object"==typeof i&&L.call(this,i,t,s,a);return t}function R(e){for(var t,r,n,i=f(e),o=i.length;o-- >0;)(t=e[r=i[o]])&&(n=!0,"_listeners"===r||R(t)||delete e[r]);return n}function I(e,t,r){this.emitter=e,this.event=t,this.listener=r}function S(e,t,r){if(!0===r)o=!0;else if(!1===r)n=!0;else{if(!r||"object"!=typeof r)throw TypeError("options should be an object or true");var n=r.async,o=r.promisify,s=r.nextTick,c=r.objectify}if(n||s||o){var l=t,f=t._origin||t;if(s&&!a)throw Error("process.nextTick is not supported");o===i&&(o="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,r=this.event;return o?s?Promise.resolve():new Promise((function(e){u(e)})).then((function(){return t.event=r,l.apply(t,e)})):(s?process.nextTick:u)((function(){t.event=r,l.apply(t,e)}))},t._async=!0,t._origin=f}return[t,c?new I(this,e,t):this]}function C(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,p.call(this,e)}I.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},C.EventEmitter2=C,C.prototype.listenTo=function(e,t,r){if("object"!=typeof e)throw TypeError("target musts be an object");var n=this;function o(t){if("object"!=typeof t)throw TypeError("events must be an object");var i,o=r.reducers,s=T.call(n,e);i=-1===s?new v(n,e,r):n._observers[s];for(var a,c=f(t),l=c.length,u="function"==typeof o,h=0;h<l;h++)a=c[h],i.subscribe(a,t[a]||a,u?o:o&&o[a])}return r=E(r,{on:i,off:i,reducers:i},{on:g,off:g,reducers:w}),s(t)?o(d(t)):o("string"==typeof t?d(t.split(/\s+/)):t),this},C.prototype.stopListeningTo=function(e,t){var r=this._observers;if(!r)return!1;var n,i=r.length,o=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)n=r[i],e&&n._target!==e||(n.unsubscribe(t),o=!0);return o},C.prototype.delimiter=".",C.prototype.setMaxListeners=function(e){e!==i&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},C.prototype.getMaxListeners=function(){return this._maxListeners},C.prototype.event="",C.prototype.once=function(e,t,r){return this._once(e,t,!1,r)},C.prototype.prependOnceListener=function(e,t,r){return this._once(e,t,!0,r)},C.prototype._once=function(e,t,r,n){return this._many(e,1,t,r,n)},C.prototype.many=function(e,t,r,n){return this._many(e,t,r,!1,n)},C.prototype.prependMany=function(e,t,r,n){return this._many(e,t,r,!0,n)},C.prototype._many=function(e,t,r,n,i){var o=this;if("function"!=typeof r)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&o.off(e,s),r.apply(this,arguments)}return s._origin=r,this._on(e,s,n,i)},C.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,r,n,i,o,s=arguments[0],a=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return!1;if(a&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(r=s.length,c)for(n=0;n<r;n++)if("symbol"==typeof s[n]){o=!0;break}o||(s=s.join(this.delimiter))}var l,u=arguments.length;if(this._all&&this._all.length)for(n=0,r=(l=this._all.slice()).length;n<r;n++)switch(this.event=s,u){case 1:l[n].call(this,s);break;case 2:l[n].call(this,s,arguments[1]);break;case 3:l[n].call(this,s,arguments[1],arguments[2]);break;default:l[n].apply(this,arguments)}if(a)l=[],A.call(this,l,e,this.listenerTree,0,r);else{if("function"==typeof(l=this._events[s])){switch(this.event=s,u){case 1:l.call(this);break;case 2:l.call(this,arguments[1]);break;case 3:l.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];l.apply(this,t)}return!0}l&&(l=l.slice())}if(l&&l.length){if(u>3)for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];for(n=0,r=l.length;n<r;n++)switch(this.event=s,u){case 1:l[n].call(this);break;case 2:l[n].call(this,arguments[1]);break;case 3:l[n].call(this,arguments[1],arguments[2]);break;default:l[n].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===s)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},C.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||h.call(this);var e,t,r,n,i,o,s=arguments[0],a=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(a&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(n=s.length,c)for(i=0;i<n;i++)if("symbol"==typeof s[i]){t=!0;break}t||(s=s.join(this.delimiter))}var l,u=[],f=arguments.length;if(this._all)for(i=0,n=this._all.length;i<n;i++)switch(this.event=s,f){case 1:u.push(this._all[i].call(this,s));break;case 2:u.push(this._all[i].call(this,s,arguments[1]));break;case 3:u.push(this._all[i].call(this,s,arguments[1],arguments[2]));break;default:u.push(this._all[i].apply(this,arguments))}if(a?(l=[],A.call(this,l,e,this.listenerTree,0)):l=this._events[s],"function"==typeof l)switch(this.event=s,f){case 1:u.push(l.call(this));break;case 2:u.push(l.call(this,arguments[1]));break;case 3:u.push(l.call(this,arguments[1],arguments[2]));break;default:for(r=new Array(f-1),o=1;o<f;o++)r[o-1]=arguments[o];u.push(l.apply(this,r))}else if(l&&l.length){if(l=l.slice(),f>3)for(r=new Array(f-1),o=1;o<f;o++)r[o-1]=arguments[o];for(i=0,n=l.length;i<n;i++)switch(this.event=s,f){case 1:u.push(l[i].call(this));break;case 2:u.push(l[i].call(this,arguments[1]));break;case 3:u.push(l[i].call(this,arguments[1],arguments[2]));break;default:u.push(l[i].apply(this,r))}}else if(!this.ignoreErrors&&!this._all&&"error"===s)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},C.prototype.on=function(e,t,r){return this._on(e,t,!1,r)},C.prototype.prependListener=function(e,t,r){return this._on(e,t,!0,r)},C.prototype.onAny=function(e){return this._onAny(e,!1)},C.prototype.prependAny=function(e){return this._onAny(e,!0)},C.prototype.addListener=C.prototype.on,C.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},C.prototype._on=function(e,t,r,n){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||h.call(this);var o,s=this;return n!==i&&(t=(o=S.call(this,e,t,n))[0],s=o[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(N.call(this,e,t,r),s):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),r?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,_.call(this,this._events[e].length,e))):this._events[e]=t,s)},C.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var r,n=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(n=A.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;r=this._events[e],n.push({_listeners:r})}for(var o=0;o<n.length;o++){var a=n[o];if(r=a._listeners,s(r)){for(var c=-1,l=0,u=r.length;l<u;l++)if(r[l]===t||r[l].listener&&r[l].listener===t||r[l]._origin&&r[l]._origin===t){c=l;break}if(c<0)continue;return this.wildcard?a._listeners.splice(c,1):this._events[e].splice(c,1),0===r.length&&(this.wildcard?delete a._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(r===t||r.listener&&r.listener===t||r._origin&&r._origin===t)&&(this.wildcard?delete a._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&R(this.listenerTree),this},C.prototype.offAny=function(e){var t,r=0,n=0;if(e&&this._all&&this._all.length>0){for(r=0,n=(t=this._all).length;r<n;r++)if(e===t[r])return t.splice(r,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(r=0,n=t.length;r<n;r++)this.emit("removeListenerAny",t[r]);this._all=[]}return this},C.prototype.removeListener=C.prototype.off,C.prototype.removeAllListeners=function(e){if(e===i)return!this._events||h.call(this),this;if(this.wildcard){var t,r=A.call(this,null,e,this.listenerTree,0);if(!r)return this;for(t=0;t<r.length;t++)r[t]._listeners=null;this.listenerTree&&R(this.listenerTree)}else this._events&&(this._events[e]=null);return this},C.prototype.listeners=function(e){var t,r,n,o,s,a=this._events;if(e===i){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!a)return[];for(o=(t=f(a)).length,n=[];o-- >0;)"function"==typeof(r=a[t[o]])?n.push(r):n.push.apply(n,r);return n}if(this.wildcard){if(!(s=this.listenerTree))return[];var c=[],l="string"==typeof e?e.split(this.delimiter):e.slice();return A.call(this,c,l,s,0),c}return a&&(r=a[e])?"function"==typeof r?[r]:r:[]},C.prototype.eventNames=function(e){var t=this._events;return this.wildcard?L.call(this,this.listenerTree,[],null,e):t?f(t):[]},C.prototype.listenerCount=function(e){return this.listeners(e).length},C.prototype.hasListeners=function(e){if(this.wildcard){var t=[],r="string"==typeof e?e.split(this.delimiter):e.slice();return A.call(this,t,r,this.listenerTree,0),t.length>0}var n=this._events,o=this._all;return!!(o&&o.length||n&&(e===i?f(n).length:n[e]))},C.prototype.listenersAny=function(){return this._all?this._all:[]},C.prototype.waitFor=function(e,t){var r=this,n=typeof t;return"number"===n?t={timeout:t}:"function"===n&&(t={filter:t}),O((t=E(t,{timeout:0,filter:i,handleError:!1,Promise,overload:!1},{filter:g,Promise:m})).Promise,(function(n,i,o){function s(){var o=t.filter;if(!o||o.apply(r,arguments))if(r.off(e,s),t.handleError){var a=arguments[0];a?i(a):n(y.apply(null,arguments).slice(1))}else n(y.apply(null,arguments))}o((function(){r.off(e,s)})),r._on(e,s,!1)}),{timeout:t.timeout,overload:t.overload})};var k=C.prototype;Object.defineProperties(C,{defaultMaxListeners:{get:function(){return k._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");k._maxListeners=e},enumerable:!0},once:{value:function(e,t,r){return O((r=E(r,{Promise,timeout:0,overload:!1},{Promise:m})).Promise,(function(r,n,i){var o;if("function"==typeof e.addEventListener)return o=function(){r(y.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var s,a=function(){s&&e.removeListener("error",s),r(y.apply(null,arguments))};"error"!==t&&(s=function(r){e.removeListener(t,a),n(r)},e.once("error",s)),i((function(){s&&e.removeListener("error",s),e.removeListener(t,a)})),e.once(t,a)}),{timeout:r.timeout,overload:r.overload})},writable:!0,configurable:!0}}),Object.defineProperties(k,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(n=function(){return C}.call(t,r,t,e))===i||(e.exports=n)}()},648:function(e,t){!function(r){"use strict";function n(e,t){if(e instanceof Boolean||"boolean"==typeof e)return!1;if(t instanceof Object||(t={}),t.hasOwnProperty("allowBlank")&&!t.allowBlank&&""===e)return!1;var r="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}==|[A-Za-z0-9+/]{3}=)?";return t.mime&&(r="(data:\\w+\\/[a-zA-Z\\+\\-\\.]+;base64,)?"+r),!1===t.paddingRequired&&(r="(?:[A-Za-z0-9+\\/]{4})*(?:[A-Za-z0-9+\\/]{2}(==)?|[A-Za-z0-9+\\/]{3}=?)?"),new RegExp("^"+r+"$","gi").test(e)}e.exports&&(t=e.exports=n),t.isBase64=n}()},634:(e,t,r)=>{"use strict";var n=r(668),i=r(648);function o(e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t.buffer}e.exports=function(e){if("string"!=typeof e)throw Error("Argument should be a string");return/^data\:/i.test(e)?function(e){var t=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===t||t<=4)throw new TypeError("malformed data-URI");for(var r=e.substring(5,t).split(";"),i=!1,s="US-ASCII",a=0;a<r.length;a++)"base64"==r[a]?i=!0:0==r[a].indexOf("charset=")&&(s=r[a].substring(8));var c=unescape(e.substring(t+1));i&&(c=n(c));var l=o(c);return l.type=r[0]||"text/plain",l.charset=s,l}(e):(i(e)&&(e=n(e)),o(e))}}},t={},r=function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}(711),r;var e,t,r}));