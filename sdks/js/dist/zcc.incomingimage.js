!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ZCC=t():(e.ZCC=e.ZCC||{},e.ZCC.IncomingImage=t())}(self,(()=>{return e={712:e=>{e.exports={ERROR_NOT_ENOUGH_PARAMS:"Not enough parameters",ERROR_INVALID_SERVER_PROTOCOL:"Invalid server protocol, use ws:// or wss://",ERROR_UNSUPPORTED:"Your browser does not support all required APIs.\nRead more here https://github.com/zelloptt/zello-channel-api",ERROR_RECORDING_NO_HTTPS:"Recording will work over https:// loaded pages only",ERROR_WIDGET_ELEMENT_NOT_FOUND:"DOM element for widget is not found",ERROR_INVALID_DECODER:"Invalid incoming message decoder. Should implement ZCC.Decoder interface",ERROR_INVALID_PLAYER:"Invalid incoming message player. Should implement ZCC.Player interface",ERROR_INVALID_RECORDER:"Invalid outgoing message recorder. Should implement ZCC.Recorder interface",ERROR_INVALID_ENCODER:"Invalid outgoing message encoder. Should implement ZCC.Encoder interface",ERROR_SESSION_FAIL_CONNECT:"Failed to connect",ERROR_INVALID_IMAGE_WIDTH_OR_HEIGHT:"Invalid image width or height",ERROR_FAILED_TO_SEND_IMAGE:"Failed to send image",ERROR_IMAGE_NOT_READY_TO_BE_SENT:"Image is not ready to be sent",ERROR_NO_CAMERA_AVAILABLE:"No camera available",ERROR_TYPE_UNKNOWN_SERVER_ERROR:"Unknown server error",ERROR_TYPE_CONFIGURATION:"configuration",EVENT_ERROR:"error",EVENT_CONNECT:"connect",EVENT_CLOSE:"close",EVENT_LOGON:"logon",EVENT_STATUS:"status",EVENT_START_STREAM:"start_stream",EVENT_STOP_STREAM:"stop_stream",EVENT_SESSION_START_CONNECT:"session_start_connect",EVENT_SESSION_CONNECT:"session_connect",EVENT_SESSION_FAIL_CONNECT:"session_fail_connect",EVENT_SESSION_CONNECTION_LOST:"session_connection_lost",EVENT_SESSION_DISCONNECT:"session_disconnect",EVENT_INCOMING_VOICE_WILL_START:"incoming_voice_will_start",EVENT_INCOMING_VOICE_DID_START:"incoming_voice_did_start",EVENT_INCOMING_VOICE_DID_STOP:"incoming_voice_did_stop",EVENT_INCOMING_VOICE_FAIL_START:"incoming_voice_fail_start",EVENT_OUTGOING_VOICE_DID_STOP:"outgoing_voice_did_stop",EVENT_INCOMING_VOICE_DATA:"incoming_voice_data",EVENT_INCOMING_VOICE_DATA_DECODED:"incoming_voice_data_decoded",EVENT_INCOMING_IMAGE_DATA:"incoming_image_data",EVENT_DATA:"data",EVENT_DATA_ENCODED:"data_encoded",EVENT_ENCODER_DONE:"encoder_done",EVENT_RECORDER_READY:"recorder_ready",EVENT_WIDGET_OPEN_BUTTON_CLICK:"widget_open_button_click",EVENT_WIDGET_MUTE:"widget_mute",EVENT_WIDGET_UNMUTE:"widget_unmute",EVENT_WIDGET_SPEAKING_USERNAME_CLICK:"speaking_username_click",EVENT_INCOMING_TEXT_MESSAGE:"incoming_text_message",EVENT_INCOMING_LOCATION:"incoming_location",EVENT_INCOMING_IMAGE:"incoming_image",EVENT_IMAGE_DATA:"image_data",EVENT_THUMBNAIL_DATA:"thumbnail_data",EVENT_IMAGE_PREVIEW_DATA:"image_preview_data",EVENT_THUMBNAIL_PREVIEW_DATA:"thumbnail_preview_data",EVENT_DISPATCH_CALL_STATUS:"dispatch_call_status",MAX_OUTGOING_IMAGE_SCALE_PX:1280,OUTGOING_IMAGE_THUMBNAIL_SCALE_PX:90,SN_STATUS_SUCCESS:"success",SN_STATUS_ONLINE:"online",SN_STATUS_OFFLINE:"offline",MESSAGE_TYPE_AUDIO:1,MESSAGE_TYPE_IMAGE:2,MESSAGE_TYPE_JSON:123,IMAGE_TYPE_FULL:1,IMAGE_TYPE_THUMBNAIL:2,TALK_PRIORITY_VALUE_NORMAL:100,TALK_PRIORITY_VALUE_LOW:10}},706:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(){return o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=s(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},o.apply(this,arguments)}function s(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}function l(e,t){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},l(e,t)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=f(e);if(t){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return c(this,n)}}function c(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(c,e);var t,n,r,s=a(c);function c(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),s.call(this,{wildcard:!0})}return t=c,n=[{key:"emit",value:function(){o(f(c.prototype),"emit",this).apply(this,arguments);var e=arguments[0];e instanceof Array&&e.length>1||"string"==typeof e&&-1!==e.indexOf(".")||(arguments[0]=(arguments[0]instanceof Array?arguments[0][0]:arguments[0])+".*",o(f(c.prototype),"emit",this).apply(this,arguments))}}],n&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),c}(n(387).EventEmitter2);e.exports=u},519:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},o(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=a(e);if(t){var i=a(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function l(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}var c=n(706),f=n(712),u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&o(e,t)}(a,e);var t,n,r,l=s(a);function a(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(n=l.call(this)).messageData=e,n.options=Object.assign({},t.options,{messageData:e}),n.instanceId=e.message_id,n.session=t,n.initSessionHandlers(),n.clearHandlersAfterFetches=2,n.numberOfFetches=0,n}return t=a,(n=[{key:"initSessionHandlers",value:function(){var e=this;this.incomingImageHandler=function(t){e.numberOfFetches++;var n=t.packetId===f.IMAGE_TYPE_FULL?f.EVENT_IMAGE_DATA:f.EVENT_THUMBNAIL_DATA;e.emit(n,t.messageData),e.numberOfFetches===e.clearHandlersAfterFetches&&e.session.off([f.EVENT_INCOMING_IMAGE_DATA,e.instanceId],e.incomingImageHandler)},this.session.on([f.EVENT_INCOMING_IMAGE_DATA,this.instanceId],this.incomingImageHandler)}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),a}(c);e.exports=u},387:(e,t,n)=>{var r;!function(i){var o=Object.hasOwnProperty,s=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},l="object"==typeof process&&"function"==typeof process.nextTick,a="function"==typeof Symbol,c="object"==typeof Reflect,f="function"==typeof setImmediate?setImmediate:setTimeout,u=a?c&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function _(){this._events={},this._conf&&h.call(this,this._conf)}function h(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==i&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function p(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning",r.emitter=this,r.count=e,process.emitWarning(r)}else console.error(n),console.trace&&console.trace()}var y=function(e,t,n){var r=arguments.length;switch(r){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(r);r--;)i[r]=arguments[r];return i}};function E(e,t){for(var n={},r=e.length,o=t?value.length:0,s=0;s<r;s++)n[e[s]]=s<o?t[s]:i;return n}function v(e,t,n){var r,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(r=n.on,i=n.off),t.addEventListener?(r=t.addEventListener,i=t.removeEventListener):t.addListener?(r=t.addListener,i=t.removeListener):t.on&&(r=t.on,i=t.off),!r&&!i)throw Error("target does not implement any known event API");if("function"!=typeof r)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=r,this._off=i;var o=e._observers;o?o.push(this):e._observers=[this]}function m(e,t,n,r){var s=Object.assign({},t);if(!e)return s;if("object"!=typeof e)throw TypeError("options must be an object");var l,a,c,f=Object.keys(e),u=f.length;function _(e){throw Error('Invalid "'+l+'" option value'+(e?". Reason: "+e:""))}for(var h=0;h<u;h++){if(l=f[h],!r&&!o.call(t,l))throw Error('Unknown "'+l+'" option');(a=e[l])!==i&&(c=n[l],s[l]=c?c(a,_):a)}return s}function d(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function b(e){var t="value must be type of "+e.join("|"),n=e.length,r=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===r)return e;n(t)}:2===n?function(e,n){var o=typeof e;if(o===r||o===i)return e;n(t)}:function(r,i){for(var o=typeof r,s=n;s-- >0;)if(o===e[s])return r;i(t)}}Object.assign(v.prototype,{subscribe:function(e,t,n){var r=this,i=this._target,o=this._emitter,s=this._listeners,l=function(){var r=y.apply(null,arguments),s={data:r,name:t,original:e};if(n){var l=n.call(i,s);!1!==l&&o.emit.apply(o,[s.name].concat(r))}else o.emit.apply(o,[t].concat(r))};if(s[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,o._newListener&&o._removeListener&&!r._onNewListener?(this._onNewListener=function(n){n===t&&null===s[e]&&(s[e]=l,r._on.call(i,e,l))},o.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!o.hasListeners(n)&&s[e]&&(s[e]=null,r._off.call(i,e,l))},s[e]=null,o.on("removeListener",this._onRemoveListener)):(s[e]=l,r._on.call(i,e,l))},unsubscribe:function(e){var t,n,r,i=this,o=this._listeners,s=this._emitter,l=this._off,a=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function c(){i._onNewListener&&(s.off("newListener",i._onNewListener),s.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=N.call(s,i);s._observers.splice(e,1)}if(e){if(!(t=o[e]))return;l.call(a,e,t),delete o[e],--this._listenersCount||c()}else{for(r=(n=u(o)).length;r-- >0;)e=n[r],l.call(a,e,o[e]);this._listeners={},this._listenersCount=0,c()}}});var T=b(["function"]),g=b(["object","function"]);function O(e,t,n){var r,i,o,s=0,l=new e((function(a,c,f){function u(){i&&(i=null),s&&(clearTimeout(s),s=0)}n=m(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),r=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof f;var _=function(e){u(),a(e)},h=function(e){u(),c(e)};r?t(_,h,f):(i=[function(e){h(e||Error("canceled"))}],t(_,h,(function(e){if(o)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),o=!0),n.timeout>0&&(s=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",s=0,l.cancel(e),c(e)}),n.timeout))}));return r||(l.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),l}function N(e){var t=this._observers;if(!t)return-1;for(var n=t.length,r=0;r<n;r++)if(t[r]._target===e)return r;return-1}function w(e,t,n,r,i){if(!n)return null;if(0===r){var o=typeof t;if("string"===o){var s,l,a=0,c=0,f=this.delimiter,_=f.length;if(-1!==(l=t.indexOf(f))){s=new Array(5);do{s[a++]=t.slice(c,l),c=l+_}while(-1!==(l=t.indexOf(f,c)));s[a++]=t.slice(c),t=s,i=a}else t=[t],i=1}else"object"===o?i=t.length:(t=[t],i=1)}var h,p,y,E,v,m,d,b=null,T=t[r],g=t[r+1];if(r===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),b=[n]):(e&&e.push.apply(e,n._listeners),b=[n]));else{if("*"===T){for(l=(m=u(n)).length;l-- >0;)"_listeners"!==(h=m[l])&&(d=w(e,t,n[h],r+1,i))&&(b?b.push.apply(b,d):b=d);return b}if("**"===T){for((v=r+1===i||r+2===i&&"*"===g)&&n._listeners&&(b=w(e,t,n,i,i)),l=(m=u(n)).length;l-- >0;)"_listeners"!==(h=m[l])&&("*"===h||"**"===h?(n[h]._listeners&&!v&&(d=w(e,t,n[h],i,i))&&(b?b.push.apply(b,d):b=d),d=w(e,t,n[h],r,i)):d=w(e,t,n[h],h===g?r+2:r,i),d&&(b?b.push.apply(b,d):b=d));return b}n[T]&&(b=w(e,t,n[T],r+1,i))}if((p=n["*"])&&w(e,t,p,r+1,i),y=n["**"])if(r<i)for(y._listeners&&w(e,t,y,i,i),l=(m=u(y)).length;l-- >0;)"_listeners"!==(h=m[l])&&(h===g?w(e,t,y[h],r+2,i):h===T?w(e,t,y[h],r+1,i):((E={})[h]=y[h],w(e,t,{"**":E},r+1,i)));else y._listeners?w(e,t,y,i,i):y["*"]&&y["*"]._listeners&&w(e,t,y["*"],i,i);return b}function L(e,t,n){var r,i,o=0,s=0,l=this.delimiter,a=l.length;if("string"==typeof e)if(-1!==(r=e.indexOf(l))){i=new Array(5);do{i[o++]=e.slice(s,r),s=r+a}while(-1!==(r=e.indexOf(l,s)));i[o++]=e.slice(s)}else i=[e],o=1;else i=e,o=e.length;if(o>1)for(r=0;r+1<o;r++)if("**"===i[r]&&"**"===i[r+1])return;var c,f=this.listenerTree;for(r=0;r<o;r++)if(f=f[c=i[r]]||(f[c]={}),r===o-1)return f._listeners?("function"==typeof f._listeners&&(f._listeners=[f._listeners]),n?f._listeners.unshift(t):f._listeners.push(t),!f._listeners.warned&&this._maxListeners>0&&f._listeners.length>this._maxListeners&&(f._listeners.warned=!0,p.call(this,f._listeners.length,c))):f._listeners=t,!0;return!0}function A(e,t,n,r){for(var i,o,s,l,a=u(e),c=a.length,f=e._listeners;c-- >0;)i=e[o=a[c]],s="_listeners"===o?n:n?n.concat(o):[o],l=r||"symbol"==typeof o,f&&t.push(l?s:s.join(this.delimiter)),"object"==typeof i&&A.call(this,i,t,s,l);return t}function I(e){for(var t,n,r,i=u(e),o=i.length;o-- >0;)(t=e[n=i[o]])&&(r=!0,"_listeners"===n||I(t)||delete e[n]);return r}function R(e,t,n){this.emitter=e,this.event=t,this.listener=n}function S(e,t,n){if(!0===n)o=!0;else if(!1===n)r=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var r=n.async,o=n.promisify,s=n.nextTick,a=n.objectify}if(r||s||o){var c=t,u=t._origin||t;if(s&&!l)throw Error("process.nextTick is not supported");o===i&&(o="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return o?s?Promise.resolve():new Promise((function(e){f(e)})).then((function(){return t.event=n,c.apply(t,e)})):(s?process.nextTick:f)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=u}return[t,a?new R(this,e,t):this]}function C(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,h.call(this,e)}R.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},C.EventEmitter2=C,C.prototype.listenTo=function(e,t,n){if("object"!=typeof e)throw TypeError("target musts be an object");var r=this;function o(t){if("object"!=typeof t)throw TypeError("events must be an object");var i,o=n.reducers,s=N.call(r,e);i=-1===s?new v(r,e,n):r._observers[s];for(var l,a=u(t),c=a.length,f="function"==typeof o,_=0;_<c;_++)l=a[_],i.subscribe(l,t[l]||l,f?o:o&&o[l])}return n=m(n,{on:i,off:i,reducers:i},{on:T,off:T,reducers:g}),s(t)?o(E(t)):o("string"==typeof t?E(t.split(/\s+/)):t),this},C.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var r,i=n.length,o=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)r=n[i],e&&r._target!==e||(r.unsubscribe(t),o=!0);return o},C.prototype.delimiter=".",C.prototype.setMaxListeners=function(e){e!==i&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},C.prototype.getMaxListeners=function(){return this._maxListeners},C.prototype.event="",C.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},C.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},C.prototype._once=function(e,t,n,r){return this._many(e,1,t,n,r)},C.prototype.many=function(e,t,n,r){return this._many(e,t,n,!1,r)},C.prototype.prependMany=function(e,t,n,r){return this._many(e,t,n,!0,r)},C.prototype._many=function(e,t,n,r,i){var o=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function s(){return 0==--t&&o.off(e,s),n.apply(this,arguments)}return s._origin=n,this._on(e,s,r,i)},C.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||_.call(this);var e,t,n,r,i,o,s=arguments[0],l=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return!1;if(l&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(n=s.length,a)for(r=0;r<n;r++)if("symbol"==typeof s[r]){o=!0;break}o||(s=s.join(this.delimiter))}var c,f=arguments.length;if(this._all&&this._all.length)for(r=0,n=(c=this._all.slice()).length;r<n;r++)switch(this.event=s,f){case 1:c[r].call(this,s);break;case 2:c[r].call(this,s,arguments[1]);break;case 3:c[r].call(this,s,arguments[1],arguments[2]);break;default:c[r].apply(this,arguments)}if(l)c=[],w.call(this,c,e,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[s])){switch(this.event=s,f){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(f-1),i=1;i<f;i++)t[i-1]=arguments[i];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(f>3)for(t=new Array(f-1),i=1;i<f;i++)t[i-1]=arguments[i];for(r=0,n=c.length;r<n;r++)switch(this.event=s,f){case 1:c[r].call(this);break;case 2:c[r].call(this,arguments[1]);break;case 3:c[r].call(this,arguments[1],arguments[2]);break;default:c[r].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===s)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},C.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||_.call(this);var e,t,n,r,i,o,s=arguments[0],l=this.wildcard;if("newListener"===s&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(l&&(e=s,"newListener"!==s&&"removeListener"!==s&&"object"==typeof s)){if(r=s.length,a)for(i=0;i<r;i++)if("symbol"==typeof s[i]){t=!0;break}t||(s=s.join(this.delimiter))}var c,f=[],u=arguments.length;if(this._all)for(i=0,r=this._all.length;i<r;i++)switch(this.event=s,u){case 1:f.push(this._all[i].call(this,s));break;case 2:f.push(this._all[i].call(this,s,arguments[1]));break;case 3:f.push(this._all[i].call(this,s,arguments[1],arguments[2]));break;default:f.push(this._all[i].apply(this,arguments))}if(l?(c=[],w.call(this,c,e,this.listenerTree,0)):c=this._events[s],"function"==typeof c)switch(this.event=s,u){case 1:f.push(c.call(this));break;case 2:f.push(c.call(this,arguments[1]));break;case 3:f.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(u-1),o=1;o<u;o++)n[o-1]=arguments[o];f.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),u>3)for(n=new Array(u-1),o=1;o<u;o++)n[o-1]=arguments[o];for(i=0,r=c.length;i<r;i++)switch(this.event=s,u){case 1:f.push(c[i].call(this));break;case 2:f.push(c[i].call(this,arguments[1]));break;case 3:f.push(c[i].call(this,arguments[1],arguments[2]));break;default:f.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===s)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(f)},C.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},C.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},C.prototype.onAny=function(e){return this._onAny(e,!1)},C.prototype.prependAny=function(e){return this._onAny(e,!0)},C.prototype.addListener=C.prototype.on,C.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},C.prototype._on=function(e,t,n,r){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||_.call(this);var o,s=this;return r!==i&&(t=(o=S.call(this,e,t,r))[0],s=o[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(L.call(this,e,t,n),s):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,p.call(this,this._events[e].length,e))):this._events[e]=t,s)},C.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,r=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(r=w.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],r.push({_listeners:n})}for(var o=0;o<r.length;o++){var l=r[o];if(n=l._listeners,s(n)){for(var a=-1,c=0,f=n.length;c<f;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){a=c;break}if(a<0)continue;return this.wildcard?l._listeners.splice(a,1):this._events[e].splice(a,1),0===n.length&&(this.wildcard?delete l._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete l._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&I(this.listenerTree),this},C.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,r=t.length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},C.prototype.removeListener=C.prototype.off,C.prototype.removeAllListeners=function(e){if(e===i)return!this._events||_.call(this),this;if(this.wildcard){var t,n=w.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&I(this.listenerTree)}else this._events&&(this._events[e]=null);return this},C.prototype.listeners=function(e){var t,n,r,o,s,l=this._events;if(e===i){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!l)return[];for(o=(t=u(l)).length,r=[];o-- >0;)"function"==typeof(n=l[t[o]])?r.push(n):r.push.apply(r,n);return r}if(this.wildcard){if(!(s=this.listenerTree))return[];var a=[],c="string"==typeof e?e.split(this.delimiter):e.slice();return w.call(this,a,c,s,0),a}return l&&(n=l[e])?"function"==typeof n?[n]:n:[]},C.prototype.eventNames=function(e){var t=this._events;return this.wildcard?A.call(this,this.listenerTree,[],null,e):t?u(t):[]},C.prototype.listenerCount=function(e){return this.listeners(e).length},C.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return w.call(this,t,n,this.listenerTree,0),t.length>0}var r=this._events,o=this._all;return!!(o&&o.length||r&&(e===i?u(r).length:r[e]))},C.prototype.listenersAny=function(){return this._all?this._all:[]},C.prototype.waitFor=function(e,t){var n=this,r=typeof t;return"number"===r?t={timeout:t}:"function"===r&&(t={filter:t}),O((t=m(t,{timeout:0,filter:i,handleError:!1,Promise,overload:!1},{filter:T,Promise:d})).Promise,(function(r,i,o){function s(){var o=t.filter;if(!o||o.apply(n,arguments))if(n.off(e,s),t.handleError){var l=arguments[0];l?i(l):r(y.apply(null,arguments).slice(1))}else r(y.apply(null,arguments))}o((function(){n.off(e,s)})),n._on(e,s,!1)}),{timeout:t.timeout,overload:t.overload})};var P=C.prototype;Object.defineProperties(C,{defaultMaxListeners:{get:function(){return P._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");P._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return O((n=m(n,{Promise,timeout:0,overload:!1},{Promise:d})).Promise,(function(n,r,i){var o;if("function"==typeof e.addEventListener)return o=function(){n(y.apply(null,arguments))},i((function(){e.removeEventListener(t,o)})),void e.addEventListener(t,o,{once:!0});var s,l=function(){s&&e.removeListener("error",s),n(y.apply(null,arguments))};"error"!==t&&(s=function(n){e.removeListener(t,l),r(n)},e.once("error",s)),i((function(){s&&e.removeListener("error",s),e.removeListener(t,l)})),e.once(t,l)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(P,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(r=function(){return C}.call(t,n,t,e))===i||(e.exports=r)}()}},t={},n=function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}(519),n;var e,t,n}));